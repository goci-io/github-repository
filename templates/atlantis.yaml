version: 3
projects:
%{ for workspace in workspaces ~}
%{ for project in projects ~}
- dir: ${project.directory}
  name: ${project.name}-${workspace.name}
  workflow: ${workspace.workflow}
  workspace: ${workspace.name}
  terraform_version: ${project.tf_version}
  autoplan:
    when_modified: ["*.tf", "*.tf*"]
    enabled: ${workspace.autoplan}
%{ endfor ~}
%{ endfor ~}
